<!--

    === Blog Post Outline ===

        - Introduction:
            - Briefly describe how I found the article and why it caught my attention.
            - Link to the "Register" article I read.
            - Link to another article that contains the IDs for the malicious extensions.
            - Link to the ISS video where I talked about this article.

        - Summary of the article:
            - Provide a concise summary of the key points from the article.
            - Highlight the main findings about the ShadyPanda malware campaign.

        - Breakdown of the various Malicious Functions and Capabilities:
            - Remote Code Execution (RCE) inside the browser.
            - Full Browser Surveillance and Spyware.
            - Injection of Malicious Content / Modification of Web Pages.
            - Anti-Analysis Abilities.
            - Real-Time User Interaction Monitoring.

        - Why this is Dangerous.

        - How can users fix this and protect themselves.

        - My Thoughts.

-->

<!-- Paragraph One: -->
<br><h3>Introduction:</h3><br>
<p>
    This week for the "News Segment" portion at ISS, I presented a summary and breakdown of a fascinating article that I read that talked about a malware campaign that lasted 7 years, impacted 4.3 Million victims, and utilized Browser Extensions to go undetected until it was too late.
    This particular story caught my attention because as someone who is building a project that involves Browser Extensions, I had the understanding that 
    code is reviewed before being published to the Extension Stores, so I was curious to learn how exactly the malicious actor was able to push so much harmful code to so many users without being detected for such a long period of time.
    You can find the original article I read on "The Register" <a href="https://www.theregister.com/2025/12/01/chrome_edge_malicious_browser_extensions/" target="blank">here</a>, another article that covers the same story but provides a list of some of the Malicious Extension IDs <a href="https://www.koi.ai/blog/4-million-browsers-infected-inside-shadypanda-7-year-malware-campaign#heading-7" target="blank">here</a>,
    and the ISSessions video where I covered this article <a href="https://www.youtube.com/watch?v=ZJQu_0HFz-Y" target="blank">here</a>.
</p><br>

<!-- Summary of the Article: -->
<h3>Summary and Key Points:</h3><br>
<p>
    A threat actor known by the moniker "ShadyPanda" ran a multi-year campaign (dating back to 2018), where they published "normal" browser extensions
    for popular browsers like Google Chrome and Microsoft Edge that had good reviews, "Featured" / "Verified" statuses, and an incredibly high amount of installs that sat in the millions.
    Nothing about these extensions seemed off or out of the ordinary..that all changed at some point in mid-late 2024.
    At that time, the threat actor pushed various updates to these extensions and transformed these once "normal" extensions into a variety of malicious pieces of software that had a wide range of harmful capabilities and were completely unbeknownst to the victims.<br>
    The malicious abilities included;
    <ul>
        <li>Remote Code Execution (RCE) inside the browser.</li>
        <li>Full Browser Surveillance and Spyware.</li>
        <li>Injection of Malicious Content / Modification of Web Pages.</li>
        <li>Anti-Analysis Abilities.</li>
        <li>Real-Time User Interaction Monitoring.</li>
    </ul><br><br>

    In total, it is estimated that over 4.3 Million users were infected by this "Supply-Chain" attack campaign across multiple different browser platforms.
    Although Google and Microsoft have done a good job of removing these malicious extensions from their stores, at the time of writing this it is said that a handful of the extensions
    are still live on the Microsoft Edge store.
    This campaign abused the trust model of browser extension markets and demonstrated how dangerous they can be by remaining dormant for years before quietly being weaponized against their users...like "sleeper agents" waiting to take down an enemy.
</p><br>

<!-- Breakdown of the Various Malicious Functions: -->
<h3>Breakdown of the Various Malicious Functions and Capabilities:</h3><br>
<p>
    <!-- Remote Code Execution (RCE) Inside the Browser: -->
    <h4>Remote Code Execution (RCE) Inside the Browser:</h4>
    Once the extensions were updated and deployed, they were able to download arbitrary Javascript (JS) code from a Command-And-Control (C2) server that is controlled by 
    the malicious actor (ShadyPanda) on an hourly basis, and execute it with full browser API access and privileges.
    This allowed the threat actor to run any code they wanted inside the victim's browser, giving them a wide range of options for further exploitation.<br><br>

    <!-- Full Browser Surveillance and Spyware: -->
    <h4>Full Browser Surveillance and Spyware:</h4>
    These extenstions were capable of collecting and exfiltrating a broad range of sensitive user data from victims including:
    <ul>
        <li>Every URL visited</li>
        <li>HTTP Referrers</li>
        <li>Timestamps (for activity profiling)</li>
        <li>Persistent Unique IDs per user for tracking</li>
        <li>Full Browser Fingerprinting</li>
    </ul><br>
    This data was sent back to the C2 server for analysis and potential further exploitation by the threat actor.<br><br>

    <!-- Injection of Malicious Content / Modification of Webpages: -->
    <h4>Injection of Malicious Content / Modification of Web Pages:</h4>
    Due to how the malicious extenstions had full access to the browser APIs, they were able to modify the content of web pages that the victims visited in real-time.
    This included injecting malicious ads, phishing forms, or other harmful content into legitimate websites, putting users at risk of further attacks.<br><br>

    <!-- Anti-Analysis Abilities: -->
    <h4>Anti-Analysis Abilities:</h4>
    The malware included a behaviour that was able to detect when browser developer tools were opened, which would cause it to switch to a "benign" behaviour
    to avoid detection and analysis by security researchers or vigilant users.
    This made it more difficult to study and understand the full extent of the malware's capabilities.<br><br>

    <!-- Real-Time User Interaction Tracking: -->
    <h4>Real-Time User Interaction Tracking:</h4>
    Some of the extensions (such as one named "WeTab") were able to track user search queries, mouse clicks, page interactions, storage access, 
    and streamed this data in real-time back to servers controlled by the threat actor.
    This allowed them to monitor user behaviour closely and potentially exploit it for further attacks.
</p><br>

<!-- Why This is Dangerous: -->
<h3>Why This is Dangerous:</h3><br>
<p>
    This campaign is dangerous for several reasons; starting with the fact that it didn't rely on any Phishing or other Social Engineering trickery.
    It exploited the implicit trust that users place in browser extension marketplaces, assuming that extensions available there have been vetted and are safe to use.
    By remaining dormant for years before activating their malicious payloads, these extensions were able to evade detection for a long time,
    allowing the threat actor to amass a large number of victims before being discovered.
    Secondly, the fact that the malware runs in the context of the browser means that it has access to a wealth of sensitive information and is able to easily 
    bypass many traditional protections and AV processes that may be in place on the user's system.
    Finally, the wide range of capabilities that the malware possesses means that it can be used for a variety of malicious purposes, from data theft to further exploitation 
    of the victim's system.
</p><br>

<!-- How Can Users Fix This and Protect Themselves: -->
<h3>How Can Users Fix This and Protect Themselves:</h3><br>
<p>
    I suggest that users take the following steps to protect themselves from similar threats in the future:
    <ul>
        <li>Regularly review and audit the browser extensions you have installed, removing any that are no longer needed or seem suspicious.</li>
        <li>Keep your browser and extensions up to date to ensure you have the latest security patches.</li>
        <li>Be cautious when installing new extensions, especially those with few reviews or from unknown developers.</li>
        <li>Consider using security software that can monitor for malicious activity within the browser.</li>
</p><br>

<!-- My Thoughts On The Article: -->
<h3>My Thoughts On The Article:</h3><br>
<p>
    This article really opened my eyes to the dangers of browser extensions and the gaping security holes that enable supply-chain attacks like this to be 
    easily executed. It made me realize that even seemingly trustworthy sources can be compromised, and that users need to be vigilant about the software they choose to install.
    As someone who is building a project that involves browser extensions, this has made me extra cautious about the security implications and the need for thorough vetting and monitoring of any extensions I may use or recommend.
</p>