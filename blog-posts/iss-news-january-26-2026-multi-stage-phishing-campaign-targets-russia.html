<!--
    === Blog Post Outline ===

        - Introduction / Opening Paragraph:
            - Briefly go over how I found the article and why it caught my attention.
            - Link to the article from "The Hacker News".
                - https://thehackernews.com/2026/01/multi-stage-phishing-campaign-targets.html
            - Link to the original posting from "Fortinet".
                - https://www.fortinet.com/blog/threat-research/inside-a-multi-stage-windows-malware-campaign
            - Link to the video of the session stream on YouTube.
                - https://www.youtube.com/watch?v=XHpCXd2waJA

        - Summary Paragraph of the Article / Story:
            - Go over the key points from the article.
            - Highlight the main findings from Fortinet about the campaign.
            - Layout the attack chain in brief.

        - Paragraph Technically Breaking Down The Attack & Attack Flow:
            - Spear Phishing & Social Engineering to download maicious .zip file. -> Initial Infection.
            - Downloading a PowerShell Loader script from GitHub.
            - Defense Suppression via Disabling Protections.
            - Reconnaissance & Persistence.
            - Deploying first payload : The Amnesia RAT.
            - Deploying second payload : Ransomware.

        - Paragraph explaining why this is dangerous.

        - Paragraph going over what people can do to protect themselves and defend this kind of attack.

        - Paragraph talking about my thoughts and conclusion.
-->

<!-- Introduction Paragraph: -->
<br><h3>Introduction</h3><br>
<p>
    This week at ISS (hosted virtually due to campus closure becuase of a terrible snow storm) I shared an article
    during the "News Segment" portion of our meeting, about a Multi-Stage phishing campaign that has been targeting Russians with
    Remote-Access-Trojans (RATs) and Ransomware. You can find the original posting from Fortinet <a href="https://www.fortinet.com/blog/threat-research/inside-a-multi-stage-windows-malware-campaign" target="blank">here</a>, 
    the news article I initially read from "The Hacker News" <a href="https://thehackernews.com/2026/01/multi-stage-phishing-campaign-targets.html" target="blank">here</a>,
    and the video stream of the session <a href="https://www.youtube.com/watch?v=XHpCXd2waJA" target="blank">here</a>.
</p><br>

<!-- Summary and Key Points of Article: -->
<h3>Summary of the Article and Key Points:</h3><br>
<p>
    Researchers at Fortinet have reported that a sophisticated multi-stage phishing campaign that has been taergeting individuals in 
    Russia. The campaign employs spear-phishing emails to deliver malicious .zip files, which contain a PowerShell 
    loader script that doenloads additional payloads from GitHub. The attackers utilize various techniques to evade
    detection, including the disabling of security protections on the victim's machine and deploying multiple payloads,
    such as the <strong>Amnesia RAT</strong> and a version of the <strong>Hakuna Matata Ransomware</strong>.
    The article goes on to detail the attack chain, from initial infection to payload deployment, and highlights the
    dangers posed by such multi-stage attacks.<br><br>

    <h4>Attack Chain / Flow:</h4>
    <ol>
        <li>Victim Receives Phishing email containing malicious .zip file.</li>
        <li>Victim extracts .zip file and runs PowerShell loader script.</li>
        <li>PowerShell script downloads additional payloads from GitHub.</li>
        <li>Script disables security protections on the victim's machine.</li>
        <li>First payload deployed: Amnesia RAT for reconnaissance and persistence.</li>
        <li>Second payload deployed: Hakuna Matata Ransomware to encrypt files.</li>
    </ol>

</p><br>

<!-- Technical Breakdown of the Attack: -->
<h3>Technical Breakdown of the Attack:</h3><br>
<p>
    <!-- 1. Victim Receives Phishing email and Malicious .zip: -->
    <h4>1. Victim Receives Phishing email containing malicious .zip file:</h4>
    This attack begins with a spear-phishing email that is sent to the victim. The email contains a .zip file attachment that is designed to
    look legitimate and entice the victim to download / open it's contents. Amongst the various decoy files within the archive
    there is a malicious shortcut file (.lnk) that has filenames in the Russian language.
    The shortcut file utilizes the usage of double file extensions (e.g. "Задание_для_бухгалтера_02отдела.txt.lnk") to fool the victim that it is simply a text file that is no different than any of the others
    in the archive.<br><br>

    <!-- 2. Victim extracts .zip file and runs PowerShell loader scripts: -->
    <h4>2. Victim Extracts .zip File & Runs PowerShell Loader Scripts:</h4>
    When the victim clicks the malicious shortcut file, it executes a PowerShell command that downloads another PowerShell
    script from a GitHub repository that is utilized in the next stage of the attack.
    The use of GitHub as a hosting platform for the attacker's payloads is a common tactic used by threat actors to evade detection, as it allows them to leverage a trusted platform to distribute their malicious code.
    The PowerShell script then sends a message to the attacker via usage of the Telegram Bot API to inform them that the first stage of the attack is complete.
    The last thing the PowerShell script does is run a Visual Basic Script ("SCRRC4ryuk.vbe") that is hosted in the same GitHub repository.<br>
    This VBS script is a piece of obfuscated code that is used to asseble together the payload for the next stage of the attack directly in the memory of the victim's machine, which is a common technique used by attackers to avoid detection by traditional antivirus software that relies on file-based signatures.
    The VBS script will also check to see if it is running with elevated permissions, and if it detects it is in fact not
    it will attempt to escalate it's permissions by repeatedly displaying a User Account Control (UAC) prompt at a delay of 3000 milliseconds until the victim eventually clicks "Yes" to allow the script to run with elevated permissions.<br><br>

    <!-- 3. Defence Suppression and Disabling Protections: -->
    <h4>3. Defence Supression & Disabling Protections:</h4>
    This step of the attack is where the attackers attempt to disable various security measures on the victim's machine.<br>
    <img src="blog-posts/media/disable_defender1.png" alt="Modification to Widows Defender scan preferences" width="500"><br>
    <img src="blog-posts/media/disable_defender2.png" alt="Sequential disabling of Defender protection features" width="500"><br>
    <img src="blog-posts/media/disable_defender3.png" alt="Registry-based enforcement of Defender Suppression" width="500"><br>
    The PowerShell script makes several modifications to the Windows Defender settings, including those impacted by...
    <ul>
        <li>Disabling Real-Time monitoring.</li>
        <li>Disabling Behavior Monitoring.</li>
        <li>Disabling Script Scanning.</li>
        <li>Disabling Archive Inspection.</li>
        <li>Disabling Administrative Diagnostic Tools.</li>
    </ul>
    The script also makes registry modifications to ensure that these settings cannot be easily re-enabled by the victim, and to prevent Windows Defender from automatically updating itself to potentially remove the attacker's payloads.
    This level of defense suppression is particularly concerning, as it significantly reduces the victim's ability to detect and respond to the attack, allowing the attackers to operate with greater freedom on the compromised system.
    The script then goes on to bypass security contols via the deployment of the tool <strong>DefendNot</strong>, which is a well-known PoC tool that was developed by security researcher
    <a href="https://github.com/es3n1n" target="_blank">es3n1n</a>. 

</p><br>