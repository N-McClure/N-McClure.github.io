<!--
    === Blog Post Outline ===

        - Introduction / Opening Paragraph:
            - Briefly go over how I found the article and why it caught my attention.
            - Link to the article from "The Hacker News".
                - https://thehackernews.com/2026/01/multi-stage-phishing-campaign-targets.html
            - Link to the original posting from "Fortinet".
                - https://www.fortinet.com/blog/threat-research/inside-a-multi-stage-windows-malware-campaign
            - Link to the video of the session stream on YouTube.
                - https://www.youtube.com/watch?v=XHpCXd2waJA

        - Summary Paragraph of the Article / Story:
            - Go over the key points from the article.
            - Highlight the main findings from Fortinet about the campaign.
            - Layout the attack chain in brief.

        - Paragraph Technically Breaking Down The Attack & Attack Flow:
            - Spear Phishing & Social Engineering to download maicious .zip file. -> Initial Infection.
            - Downloading a PowerShell Loader script from GitHub.
            - Defense Suppression via Disabling Protections.
            - Reconnaissance & Persistence.
            - Deploying first payload : The Amnesia RAT.
            - Deploying second payload : The Hakuna Matata Ransomware.

        - Paragraph explaining why this is dangerous.

        - Paragraph going over what people can do to protect themselves and defend this kind of attack.

        - Paragraph talking about my thoughts and conclusion.
-->

<!-- Introduction Paragraph: -->
<br><h3>Introduction</h3><br>
<p>
    This week at ISS (hosted virtually due to campus closure becuase of a terrible snow storm) I shared an article
    during the "News Segment" portion of our meeting, about a Multi-Stage phishing campaign that has been targeting Russians with
    Remote-Access-Trojans (RATs) and Ransomware. You can find the original posting from Fortinet <a href="https://www.fortinet.com/blog/threat-research/inside-a-multi-stage-windows-malware-campaign" target="blank">here</a>, 
    the news article I initially read from "The Hacker News" <a href="https://thehackernews.com/2026/01/multi-stage-phishing-campaign-targets.html" target="blank">here</a>,
    and the video stream of the session <a href="https://www.youtube.com/watch?v=XHpCXd2waJA" target="blank">here</a>.
</p><br>

<!-- Summary and Key Points of Article: -->
<h3>Summary of the Article and Key Points:</h3><br>
<p>
    Researchers at Fortinet have reported that a sophisticated multi-stage phishing campaign that has been taergeting individuals in 
    Russia. The campaign employs spear-phishing emails to deliver malicious .zip files, which contain a PowerShell 
    loader script that downloads additional payloads from GitHub. The attackers utilize various techniques to evade
    detection, including the disabling of security protections on the victim's machine and deploying multiple payloads,
    such as the <strong>Amnesia RAT</strong> and a version of the <strong>Hakuna Matata Ransomware</strong>.
    The article goes on to detail the attack chain, from initial infection to payload deployment, and highlights the
    dangers posed by such multi-stage attacks.<br><br>

    <h4>Attack Chain / Flow:</h4>
    <ol>
        <li>Victim Receives Phishing email containing malicious .zip file.</li>
        <li>Victim extracts .zip file and runs PowerShell loader script.</li>
        <li>PowerShell script downloads additional payloads from GitHub.</li>
        <li>Script disables security protections on the victim's machine.</li>
        <li>First payload deployed: Amnesia RAT for reconnaissance and persistence.</li>
        <li>Second payload deployed: Hakuna Matata Ransomware to encrypt files.</li>
    </ol>

</p><br>

<!-- Technical Breakdown of the Attack: -->
<h3>Technical Breakdown of the Attack:</h3><br>
<p>
    <!-- 1. Victim Receives Phishing email and Malicious .zip: -->
    <h4>1. Victim Receives Phishing email containing malicious .zip file:</h4>
    This attack begins with a spear-phishing email that is sent to the victim. The email contains a .zip file attachment that is designed to
    look legitimate and entice the victim to download / open it's contents. Amongst the various decoy files within the archive
    there is a malicious shortcut file (.lnk) that has filenames in the Russian language.
    The shortcut file utilizes the usage of double file extensions (e.g. "Задание_для_бухгалтера_02отдела.txt.lnk") to fool the victim that it is simply a text file that is no different than any of the others
    in the archive.<br><br>

    <!-- 2. Victim extracts .zip file and runs PowerShell loader scripts: -->
    <h4>2. Victim Extracts .zip File & Runs PowerShell Loader Scripts:</h4>
    When the victim clicks the malicious shortcut file, it executes a PowerShell command that downloads another PowerShell
    script from a GitHub repository that is utilized in the next stage of the attack.
    The use of GitHub as a hosting platform for the attacker's payloads is a common tactic used by threat actors to evade detection, as it allows them to leverage a trusted platform to distribute their malicious code.
    The PowerShell script then sends a message to the attacker via usage of the Telegram Bot API to inform them that the first stage of the attack is complete.
    The last thing the PowerShell script does is run a Visual Basic Script ("SCRRC4ryuk.vbe") that is hosted in the same GitHub repository.<br>
    This VBS script is a piece of obfuscated code that is used to asseble together the payload for the next stage of the attack directly in the memory of the victim's machine, which is a common technique used by attackers to avoid detection by traditional antivirus software that relies on file-based signatures.
    The VBS script will also check to see if it is running with elevated permissions, and if it detects it is in fact not
    it will attempt to escalate it's permissions by repeatedly displaying a User Account Control (UAC) prompt at a delay of 3000 milliseconds until the victim eventually clicks "Yes" to allow the script to run with elevated permissions.<br><br>

    <!-- 3. Defence Suppression and Disabling Protections: -->
    <h4>3. Defence Supression & Disabling Protections:</h4>
    This step of the attack is where the attackers attempt to disable various security measures on the victim's machine.<br><br>
    <img src="blog-posts/media/disable_defender1.png" alt="Modification to Widows Defender scan preferences" width="500"><br>
    <img src="blog-posts/media/disable_defender2.png" alt="Sequential disabling of Defender protection features" width="500"><br>
    <img src="blog-posts/media/disable_defender3.png" alt="Registry-based enforcement of Defender Suppression" width="500"><br>
    The PowerShell script makes several modifications to the Windows Defender settings, including those impacted by...
    <ul>
        <li>Disabling Real-Time monitoring.</li>
        <li>Disabling Behavior Monitoring.</li>
        <li>Disabling Script Scanning.</li>
        <li>Disabling Archive Inspection.</li>
        <li>Disabling Administrative Diagnostic Tools.</li>
    </ul><br>
    The script also makes registry modifications to ensure that these settings cannot be easily re-enabled by the victim, and to prevent Windows Defender from automatically updating itself to potentially remove the attacker's payloads.
    This level of defense suppression is particularly concerning, as it significantly reduces the victim's ability to detect and respond to the attack, allowing the attackers to operate with greater freedom on the compromised system.
    The script then goes on to bypass security contols via the deployment of the tool <strong>DefendNot</strong>, which is a well-known PoC tool that was developed by security researcher
    <a href="https://github.com/es3n1n" target="_blank">es3n1n</a>. Please note that I am linking this tool for the purpose of education and malware analysis, I do not 
    encourage anyone to use this tool for malicious purposes.<br><br>

    <!-- 4. Reconnaissance & Persistence: -->
    <h4>4. Reconnaissance & Persistence:</h4>
    Once the attack has successfully bypassed the victim's security controls, the script utilizes the use of the 
    the Telegram Bot API to send a message to the attacker with an abundance of information about the victim's hardware,
    network configuration, and security measures. The script also fetches a screen capturing program from the same GitHub repository that the other script was pulled from.
    This screen capturing program is used to undetectedly capture screenshots of the victim's machine at iterations 
    of 30 seconds, and send them to the attacker via the Telegram Bot API.<br><br>

    <!-- 5. Deploying Payload One - Amnesia RAT: -->
    <h4>5. Deploying Payload One - Amnesia RAT:</h4>
    The Visual Basic Script then downloads and executes a Remote Access Trojan (RAT) called "Amnesia RAT", which is designed to 
    accomplish several functions for the attacker, including:
    <ul>
        <li>Stealing Browser Credentials and Session Data.</li>
        <li>Hijacking Telegram Desktop Sessions.</li>
        <li>Discovery of Seed Phrases and Clipboard Monitoring.</li>
        <li>Theft of Discord and Steam Data.</li>
        <li>Checking for Cryptocurrency Wallets and Financial Assets.</li>
        <li>Collection of System and Hardware Information.</li>
        <li>Surveillance of Screen, Audio, and Online Activity.</li>
        <li>Control of Processes and Systems.</li>
        <li>Exfiltration of Files and Data from the Victim's Machine.</li>
    </ul><br>
    The deployment of this RAT allows the attackers to gain a significant amount of control and access to the victim's machine, 
    as well as the ability to steal sensitive information and monitor the victim's activities without their knowledge.<br><br>

    <!-- 6. Deploying Payload Two - Hakuna Matata Ransomware: -->
    <h4>6. Deploying Payload Two - Hakuna Matata Ransomware:</h4>
    Once the RAT has been deployed and is running on the victim's machine, the script then goes on to download a secondary payload,
    which is a version of the Hakuna Matata Ransomware. The ransomware is launched in a hidden PowerShell window upon execution.
    When the ransomware is executed, it goes through the victim's file system and encrypts files of various types, including 
    documents, images, media files, and more. After the ecryption of the files is complete, the ransomware then 
    appends the extension "@NeverMind12F" to the end of the encrypted files and then displays a ransom note to the victim's 
    screen with instructions on how to contact the attackers to potentially recover their files. The ransom note also includes a warning that if the victim attempts to remove the ransomware or recover their files without contacting the attackers, they will lose access to their files permanently.<br><br>

    <img src="blog-posts/media/ransomNote.png" alt="Ransom Note Displayed by Hakuna Matata Ransomware" width="500"><br>
    The message displayed in the ransom note above translates to the foloowing in English: <br>
    "Your Entire Device has been hacked. All your files are now encrypted only for you, but I have direct access to them. 
    In general, write to TG to recieve further rescue instructions. 
    My TG: @NeverMind12F or write to the original TG account (I'm waiting for your message). 
    There are exactly 2 HOURS left in your digital life. I advise you to write right away, otherwise 
    you will be very upset when you find out the conditions."
</p><br>

<!-- Why This is Dangerous: -->
<h3>Why This is Dangerous:</h3><br>
<p>
    This multi-stage phishing campaign is particularly dangerous because it combines several sophisticated techniques to evade detection and maximize the 
    impact of the attack. The use of spear-phishing emails allows the attackers to target specific individuals 
    with tailored messages that are more likely to trick them into opening the malicious attachment. 
    The use of GitHub to host the attacker's payloads allows them to leverage the trust asspciated with a reputable platform to distribute their malicious code, making it 
    less likely to be flagged by secuity software programs. The defense suppression techniques used in the attack systematically disables the victim's security measures, leaving them completely vulnerable and granting the attackers freedom 
    to operate on the system without the fear of detection. The deployment of both the Amnesia RAT and the variation of the Hakuna Matata Ransomware allows the attackers to not only steal sensitive information and monitor the victim's activities, but also 
    to cause significant damage to the victim's files and data, potentially leading to incredible financial loss and disruption to the victim's personal / professional life.
</p><br>

<!-- How to Protect Yourself: -->
<h3>How People Can Protect Themselves: </h3>