<!--

    === Blog Post Outline ===

    - Introduction:
        - Briefly describe how I found this article (add link to article), and how I talked about it at ISS this week (add link to ISS video).
    
    - Summary of the Article / Key points.

    - Technical Breakdown of the Attack:
        - Explain the concept of "Browser-in-the-Browser" (BitB) attacks.
        1. Initial Landing / Bot-Check
        2. Luring the Victim
        3. Fake Browser-in-the-Browser (BitB) Login prop-up
        4. Exfiltration and Account Takeover
        5. Evasion and Resilience
        6. Passkeys and Downgrade Attacks

    - Why is this attack effective?

    - Defensive Measures and Recomendations.

    - My thouhgts on the article and attack.

-->

<!-- Opening Paragraph: -->
<h3>Introduction:</h3><br>
<p>
    This week at ISS, I shared an interesting article that I came across and shared during the "News Segment" section of the session.
    The <a href="https://thehackernews.com/2025/11/sneaky-2fa-phishing-kit-adds-bitb-pop.html">article</a> talks about a new kit that is being used in phishing campaigns to utilize a technique called "Browser-in-the-Browser" (BitB) attacks.
    You can watch the full session <a href="https://www.youtube.com/watch?v=S2OxKKM7R6U&t=3964s" target="_blank">here</a> on YouTube.
</p><br>

<!-- Summary and Key Points of the Article: -->
<h3>Summary of the Article and Key Points:</h3><br>
<p>
    The kit which is being used for these attacks has been observed by "Push Security" researchers to mainly be targeting Microsoft accounts.
    The attackers are leveraging the BitB technique to show a fake pop-up window inside the browser that looks like a legitimate login prompt (with the URL bar...etc), 
    but it is in fact a  malicious iframe / HTML overlay.<br><br>

    <h4>Attack Flow:</h4>
    <ol>
        <li>The victim lands on a malicious URL (i.e. "previewdoc[.]us")</li>
        <li>The victim is shown a spoofed "bot-check" (Cloudflare Turnstile).</li>
        <li>The page then displays a prompt for the victim to "Login with Microsoft" to view the PDF.</li>
        <li>After the victim clicks the login button, the BitB login page is displayed and the victim enters their credentials into the input fields.</li>
        <li>Once the credentials have been inputted by the victim the credentials and the session details are then exfiltrated.</li>
    </ol><br><br>

    The article also talks about how the phishing kit has built-in anti-analysis and evasion measures such as; the disabling of developer tools, 
    rapidly rotated domains, and conditional loading (target filtering) so only the intended victims are served the phishing page.
    It is also mentioned that the kit supports Passkeys, and can even perform downgrade attacks to trick users into entering their passwords instead of using Passkeys.
    The key takeaway from this article is that Phishing attacks are continuously evolving and becoming more sophisticated, making it crucial for users to stay vigilant and for organizations to implement robust security measures.
</p><br>

<!-- Technical Breakdown of the Attack: -->
<h3>Technical Breakdown of the Attack:</h3><br>
<p>
    <!-- Initial Landing & "Bot-Check": -->
    <h4>1. Initial Landing & Bot-Check:</h4>
    This attack begins when the victim is directed to a malicious URL, such as "previewdoc[.]us", which hosts the phishing kit via a phishing email or another social engineering method.
    Before anything malicious shows, the page displays a spoofed Cloudflare Turnstile (or similar) bot challenge.
    This serves two purposes: to filter out automated scanning tools crawlingt the page, and to delay / arrest non-human traffic...making detection harder.
    Conditional loading is applied to only serve the malicious content if certain criteria are met (i.e. Geolocation, IP reputation, Browser Type...etc).
    This ensures that only the intended victims are served the phishing page, otherwise benign content is shown.<br><br>

    <!-- Luring the Victim: -->
    <h4>2. Luring the Victim:</h4>
    After clearing the "Bot-Check", the victim is presented with a page that offers something enticing...in this case it is a document that they must "Login with Microsoft" to view.
    The page is designed to look legitimate and trustworthy, often mimicking the style and branding of well-known services.
    The "Login" button triggers the loading of the BitB login prompt.<br><br>

    <!-- Fake Browser-in-the-Browser (BitB) Login pop-up: -->
    <h4>3. Fake Browser-in-the-Browser (BitB) Login Pop-Up:</h4>
    The Browser-in-the-Browser (BitB) technique is a key innovation in the way phishing attacks are being executed against targets.
    Rather than redirecting the victim wholly to a fake login page on a phishing domain, the attacker embeds an HTML/CSS overlay (or iframe) 
    that looks like a genuine browser window complete with URL bar, security indicators, and branding.
    This overlay is designed to mimic the look and feel of a real login prompt, making it difficult for victims to discern its fraudulent nature.
    When the victim clicks the "Login with Microsoft" button, this BitB login prompt is displayed, prompting them to enter their credentials.<br><br>

    <img class="gif" src="blog-posts/media/BitB_demo.gif"><br><br>

    <!-- Exfiltration and Account Takeover: -->
    <h4>4. Exfiltration and Account Takeover:</h4>
    Once credentials (and often Multi-Facator Authentication codes or Session Cookies) are captured, the attacker uses them to log into the real account and take over the victim's session and hijack their account.
    Because the attacker captures session cookies as well, they can bypass certain security measures and maintain access even if the victim changes their password later on.<br><br>

    <!-- Evasion & Resilience: -->
    <h4>5. Evasion & Resilience:</h4>
    This phishing kit incorporates a plethora of evasion techniques to avoid detection from victims and analysis from security researchers.
    These include;
    <ul>
        <li><strong>Disabling Browser Developer Tools</strong> so that if a user tries to inspect the page things will break or the overlay will hide things.</li>
        <li><strong>Rapidly Rotated Domains</strong> to avoid blacklisting and make takedown efforts more difficult.</li>
        <li><strong>Conditional Loading</strong> to ensure that only intended targets see the phishing content.</li>
        <li><strong>Use of spoofed "Bot-Checks"</strong> prevents automated crawling by researchers and tools.</li>
    </ul><br><br>

    <!-- Passkeys & Downgrade Attacks: -->
    <h4>6. Passkeys & Downgrade Attacks:</h4>
    The phishing kit also supports Passkeys, which are becoming more common as a passwordless authentication method.
    However, the kit can perform downgrade attacks to trick users into entering their passwords instead of using Passkeys.
    This is done by presenting the victim with a prompt that suggests they need to enter their password for compatibility reasons, thereby bypassing the security benefits of Passkeys.
</p><br>

<!-- Why is this attack effective?: -->
<h3>Why is this Attack Effective?</h3><br>
<p>
    This attack is effective for several reasons:
    <ul>
        <li><strong>Realistic Appearance:</strong> The BitB technique creates a convincing illusion of a legitimate login prompt, making it difficult for victims to recognize the fraud.</li>
        <li><strong>Bypassing Traditional Defenses:</strong> Since the phishing page is served within a legitimate domain and uses overlays, it can evade traditional URL-based detection methods.</li>
        <li><strong>Advanced Evasion Techniques:</strong> The use of bot-checks, conditional loading, and developer tool disabling makes it harder for security researchers to analyze and detect the phishing kit.</li>
        <li><strong>Targeted Approach:</strong> The conditional loading ensures that only specific targets see the phishing content, reducing the likelihood of detection by automated systems.</li>
    </ul>
</p><br>

<!-- Defensive Measures & Recommendations: -->
<h3>Defensive Measures and Recommendations:</h3><br>
<p>
    To defend against BitB attacks and similar phishing techniques, consider the following measures:
    <ul>
        <li><strong>User Education:</strong> Train users to recognize phishing attempts and be cautious when entering credentials, especially on unexpected prompts.</li>
        <li><strong>Multi-Factor Authentication (MFA):</strong> Implement MFA to add an additional layer of security, making it harder for attackers to gain access even if credentials are compromised.</li>
        <li><strong>Browser Security Features:</strong> Encourage users to keep their browsers updated and utilize built-in security features that can help identify fraudulent sites.</li>
        <li><strong>Anti-Phishing Solutions:</strong> Deploy advanced anti-phishing solutions that can detect and block sophisticated phishing attempts.</li>
        <li><strong>Regular Security Audits:</strong> Conduct regular security audits and penetration testing to identify vulnerabilities in your systems and improve defenses.</li>
    </ul>
</p><br>

<!-- My Thoughts: -->
<h3>My Thoughts on the Article and Attack:</h3><br>
<p>
    This article caught my attention because of the innovative use of the Browser-in-the-Browser technique in phishing attacks.
    Phishing has always been a significant threat, but the evolution of techniques like BitB shows how attackers are continuously adapting to bypass security measures and exploit user trust.
    As toolkits like these become more prevalent and easily accessible, it is crucial for both users and organizations to stay informed about emerging threats and implement robust security practices.
    Overall, this article serves as a reminder of the ever-evolving nature of cyber threats and the importance of vigilance in cybersecurity.
</p>
